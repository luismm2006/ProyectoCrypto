<section class="max-w-2xl mx-auto">
    <h2 class="text-3xl font-bold text-white mb-8 text-center">Codificar Nueva Misi贸n</h2>

    <div class="bg-agency-gray p-8 rounded-xl border border-gray-700 shadow-2xl">

        <form [formGroup]="misionForm" (ngSubmit)="guardarMision()" class="space-y-6">

            <div>
                <label class="block text-sm font-medium text-gray-400 mb-1">C贸digo de Misi贸n</label>
                <div class="relative">
                    <input 
                        type="text" 
                        formControlName="codigo"
                        placeholder="ABC-123"
                        class="w-full bg-black/40 border border-gray-600 rounded-md py-3 px-4 text-white focus:ring-2 focus:ring-agency-green focus:border-transparent transition"
                        [class.border-red-500]="notValidField('codigo')">
                    
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                        <span class="text-gray-500"></span>
                    </div>
                </div>
                <p class="text-xs text-gray-500 mt-1">Formato requerido: 3 letras, gui贸n, 3 n煤meros.</p>
                
                @if (notValidField('codigo')) {
                    <span class="text-red-500 text-xs italic mt-1 block">
                        {{ getFieldError('codigo') }}
                    </span>
                }
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-400 mb-1">Nombre en Clave</label>
                <input 
                    type="text" 
                    formControlName="titulo"
                    class="w-full bg-black/40 border border-gray-600 rounded-md py-3 px-4 text-white focus:ring-2 focus:ring-agency-green focus:border-transparent transition"
                    [class.border-red-500]="notValidField('titulo')">
                
                @if (notValidField('titulo')) {
                    <span class="text-red-500 text-xs italic mt-1 block">
                        {{ getFieldError('titulo') }}
                    </span>
                }
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Nivel de Secreto</label>
                    <select 
                        formControlName="secreto"
                        class="w-full bg-black/40 border border-gray-600 rounded-md py-3 px-4 text-white focus:ring-2 focus:ring-agency-green focus:border-transparent transition">
                        <option value="Bajo">Bajo</option>
                        <option value="Medio">Medio</option>
                        <option value="Alto">Alto</option>
                        <option value="CRTICO">CRTICO</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-1">Agente Asignado (ID)</label>
                    <input 
                        type="number" 
                        formControlName="agenteId"
                        placeholder="ID num茅rico"
                        class="w-full bg-black/40 border border-gray-600 rounded-md py-3 px-4 text-white focus:ring-2 focus:ring-agency-green focus:border-transparent transition"
                        [class.border-red-500]="notValidField('agenteId')">
                    
                    @if (notValidField('agenteId')) {
                        <span class="text-red-500 text-xs italic mt-1 block">
                            {{ getFieldError('agenteId') }}
                        </span>
                    }
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-400 mb-1">Objetivos de la Misi贸n</label>
                <textarea 
                    rows="4" 
                    formControlName="descripcion"
                    class="w-full bg-black/40 border border-gray-600 rounded-md py-3 px-4 text-white focus:ring-2 focus:ring-agency-green focus:border-transparent transition"
                    [class.border-red-500]="notValidField('descripcion')"></textarea>
                
                @if (notValidField('descripcion')) {
                    <span class="text-red-500 text-xs italic mt-1 block">
                        {{ getFieldError('descripcion') }}
                    </span>
                }
            </div>

            <div class="flex gap-4 pt-4">
                <button 
                    type="button" 
                    (click)="misionForm.reset({ secreto: 'Bajo' })"
                    class="w-1/3 py-3 px-4 border border-gray-600 text-gray-300 rounded hover:bg-gray-700 transition font-bold">
                    CANCELAR
                </button>
                
                <button 
                    type="submit"
                    class="w-2/3 py-3 px-4 bg-agency-green hover:bg-green-600 text-black rounded transition font-bold shadow-[0_0_15px_rgba(16,185,129,0.4)] disabled:opacity-50 disabled:cursor-not-allowed">
                    INICIAR PROTOCOLO
                </button>
            </div>
        </form>

    </div>
</section>